===========pbrt

Photon mapping is one of a family of particle-tracing algorithms, which are based on the
idea of constructing paths starting from the lights and connecting vertices in these paths
to the camera to deposit energy on the film.   



A particle-tracing algorithm generates a set of N samples of illumination at points pj, on
surfaces in the scene  



The photon mapping algorithm is based on tracing particles into the scene and blurring
their contribution to approximate the incident illumination at shading points.   



按理来说光源朝镜面发射的光一定会打到漫反射物体，这个时候漫反射物体就会比较亮。  想象一下一个晴朗的早晨，你用镜子反射太阳光照到教室的墙壁上。

那么bounce 的时候，每一步都需要和光线测相交

可能您听过双向路径追踪这个技术，即从光发出光线，构成光路径，同时从相机发出光线，构成光路
径，然后将两个路径的每个漫反射节点分别连接，根据联合概率密度，计算光照强度  

平衡KD树

=============Realistaic Image Synthesis

Instead of tightly coupling lighting information with the geometry, the information is stored in a separate independent data structure

section 3.1

光子总是走直线，且在行走中radiance 保持不变。that light scattering at surface is symmetric。

```
struct photon
{
	float x,y,z;	//position
	char p[4];		//power packed as 4 chars
	char phi,theta; //compressed incident direction
	short flag;		//f
}
```

