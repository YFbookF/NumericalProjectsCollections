Modeling Anisotropic Surface Reflectance with Example-Based Microfacet Synthesis  

![image-20211030150950714](D:\å®šç†\å…‰ç…§\image-20211030150950714.png)

===========Crash Course in BRDF Implementation  

The BRDF describes reflectance of the surface for given combination of incoming and outgoing
light direction. In other words, it determines how much light is reflected in given direction when certain
amount of light is incident from another direction, depending on properties of the surface.  

å¯¹äºç²—ç³™çš„è¡¨é¢ï¼ŒBRDFå‡ ä¹ä¸åå°„ï¼Œå¯¹äºé•œå­ï¼ŒBRDFå‡ ä¹å…¨åå°„åˆ°ä¸€ä¸ªæ–¹å‘ã€‚ä¸”BRDFä¸åŒºåˆ†ç›´æ¥å…‰å’Œä¸ç›´æ¥å…‰ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°å…‰å’Œå…¨å±€å…‰ã€‚

Helmholtz reciprocity â€“ the incoming and outgoing directions can be swapped (hence the name bidirectional), and the resulting reflectance will be the same. Note that some algorithms trace light rays originating from the camera (path tracing), other from the light sources (photon mapping) or both (bidirectional path tracing). Helmholtz reciprocity ensures consistent results for all types of algorithms  

Lambertian is one of the simplest BRDF functions used for diffuse term which assumes that incident light is scattered in all possible directions equally (within the hemisphere around the surface normal), but it is still a good approximation for behavior of many real-world materials and is very fast to evaluate.   

```
brdfLambertian = (diffuseReflectance / PI) * dot(N,L);
```



phong

```
brdfPhong = specular_reflectance * pow(dot(R, V), shininess) * dot(N, L);
```



ï‚· D Term â€“ A microfacet distribution function â€“ tells us what fraction of microfacets are oriented
in direction ğ» so that light incoming from direction L will be reflected in direction ğ‘‰.
ï‚· F Term â€“ Fresnel term, evaluates how much light is reflected off the surface under given angle
of incidence.
ï‚· G Term â€“ Geometric attenuation term (also masking and shadowing term denoted ğºà¬¶ later in
this text), accounts for mutual shadowing (and masking) of microfacets, sometimes also used
for normalization of BRDF.
ï‚· Denominator â€“ comes from derivation of the microfacet model using perfect mirrors as
microfacets. Note that original paper by Cook and Torrance [30] uses the constant Ï€ instead
of 4 in denominator. Walter points out [32] this is due to different normalization of ğ· term,
and most recent literature agrees on using the constant 4.  

=============Notes on the Ward BRDF  

Another useful BRDF operation is bounding its maximum value over a set of directions. While this is a much less common operation than sampling, it is a powerful operation that is required by some rendering algorithms [Walter et al. 2005].   

The second component is a gaussian anisotropic gloss lobe defined by three parameters, Ïs, Î±x, and Î±y, as:  
$$
f_r(\bold i,\bold o) = \frac{\rho_s}{4\pi \alpha_x\alpha_y\sqrt{(\bold i \cdot \bold n)(\bold o \cdot \bold n)}}exp(-\frac{((\bold h \cdot \bold x)/\alpha_x)^2 + ((\bold h \cdot \bold y) / \alpha_y)^2}{(\bold h \cdot \bold n)^2})
$$
rho_s controls the magnitude of the lobe, ax an ay control the width of the lobe in the two principal directions of anisotropy.

![image-20211031094159304](D:\å®šç†\å…‰ç…§\image-20211031094159304.png)